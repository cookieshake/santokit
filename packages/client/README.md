# @santokit/client

Type-safe Client SDK for calling Santokit logic from your frontend or backend. It uses the type definitions generated by `stk sync` so that your client code always matches your deployed logic.

## Key Ideas

- Logic files map directly to strongly typed methods.
- Types are generated from the active deployment manifest.
- The SDK is lightweight and ships only what you call.

## Installation

```bash
npm install @santokit/client
```

## Generate Types

First, generate the client types from your project:

```bash
stk sync
```

This produces a type definition file (for example `santokit-env.d.ts` or a configured output path) that you import into your app.

## Usage

### Initialize The Client

```typescript
import { createClient } from '@santokit/client';
import './.stk/santokit-env';

const client = createClient({
  baseUrl: 'https://your-bridge-url.com',
});
```

### Execute Logic

If you have a logic file at `logic/users/get.sql`:

```typescript
const user = await client.users.get({ id: '123' });
```

### Authentication

```typescript
const session = await client.auth.login({
  email: 'user@example.com',
  password: 'secret',
});

const token = await client.auth.getToken();
```

### SSR / Node.js Token Storage

```typescript
import { createClient } from '@santokit/client';

const tokenStorage = {
  token: null as string | null,
  async getToken() { return this.token; },
  async setToken(token: string) { this.token = token; },
  async removeToken() { this.token = null; },
};

const client = createClient({
  baseUrl: 'https://your-bridge-url.com',
  tokenStorage,
});
```

### Error Handling

```typescript
try {
  await client.orders.create({ item: 'box' });
} catch (error) {
  console.error('Failed:', error.message);
}
```

## Development

```bash
npm install
npm run build
npm run dev
npm test
```

## Troubleshooting

- If types look stale, re-run `stk sync` and restart your TypeScript server.
- If calls fail, confirm the Bridge `baseUrl` and auth token.
